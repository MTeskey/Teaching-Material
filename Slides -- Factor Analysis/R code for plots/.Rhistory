library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .1] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
guide = F, na.value = 'white') +
xlab('Factor') +
ylab('Variable')
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .1] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red", na.value = 'white') +
xlab('Factor') +
ylab('Variable')
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .2] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable')
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .1] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable')
source('theme_pub.R')
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
theme_pub() +
xlab('Factor') +
ylab('Variable')
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable') +
theme(axis.text.x = element_text(size = 2))
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable') +
theme(axis.text.x = element_text(size = 15))
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .1] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable') +
theme(axis.text.x = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"))
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .1] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"))
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text=element_text(size = 12))
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient(limits=c(-1, 1),
low = "blue", high = "red",
na.value = 'white') +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
rot = fit[,1:5] #varimax(fit$rotation[,1:5])
rot = fit$rotation[,1:5] #varimax(fit$rotation[,1:5])
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot)
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
fit = prcomp(data[complete.cases(data),])
rot = varimax(fit$rotation[,1:5])
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
plotFrame$Loading[abs(plotFrame$Loading) < .1] = NA
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
# Plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(rot$loadings[1:44,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
postscript('../Latex/figures/personality_factor_rot.eps',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 7.5, height = 3, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
postscript('../Latex/figures/personality_factor_rot.eps',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 4, height = 8, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
postscript('../Latex/figures/personality_factor_rot.eps',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 4, height = 8, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
?postscript
postscript('../Latex/figures/personality_factor_rot.eps',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 4, height = 7.5, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
postscript('../Latex/figures/personality_factor_rot.eps',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 4, height = 7.5, pointsize = 9)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
?png
png('../Latex/figures/personality_factor_rot.eps',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 400, height = 800, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
png(filename = '../Latex/figures/personality_factor_rot.png',
horizontal = FALSE, onefile = FALSE, paper = "special",
width = 400, height = 800, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
png(filename = '../Latex/figures/personality_factor_rot.png',
width = 400, height = 800, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
png(filename = '../Latex/figures/personality_factor_rot.png',
width = 800, height = 800, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
setwd('/media/areshenk/StorageDisk1/Writings/Teaching-Material/Slides -- Factor Analysis/R code for plots')
require(foreign)
raw = read.spss('personality.sav',
to.data.frame = F,
use.value.labels = F)
data = as.data.frame(raw)
varNames = as.character(attr(raw, "variable.labels"))
fit = prcomp(data[complete.cases(data),])
rot = varimax(fit$rotation[,1:5])
# Rotated plot
library(ggplot2)
library(reshape)
plotFrame = data.frame(fit$rotation[,1:5])
plotFrame$Variable = varNames
plotFrame = melt(plotFrame)
colnames(plotFrame) = c('Variable', 'Factor', 'Loading')
png(filename = '../Latex/figures/personality_factor_unrot.png',
width = 800, height = 800, pointsize = 10.5)
ggplot(plotFrame, aes(Factor, Variable)) +
geom_tile(aes(fill = Loading), colour = "white") +
scale_fill_gradient2(limits=c(-1, 1),
low = "blue", mid = 'white',  high = "red") +
xlab('Factor') +
ylab('Variable') +
theme(axis.text = element_text(size = 15),
axis.title = element_text(size = 16,face="bold"),
legend.text = element_text(size = 12),
legend.title = element_text(size = 15))
dev.off()
setwd('/media/areshenk/StorageDisk1/Writings/Teaching-Material/Slides -- Factor Analysis/R code for plots')
require(foreign)
raw = read.spss('personality.sav',
to.data.frame = F,
use.value.labels = F)
data = as.data.frame(raw)
varNames = as.character(attr(raw, "variable.labels"))
fit = prcomp(data[complete.cases(data),])
rot = varimax(fit$rotation[,1:5])
rot
fit
summary(fit)
summary(fit)[3,]
plot(fit)
?eigs
vexp = fit$sdev^2
plot(1:44, vexp/sum(vexp))
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
lty = 'b')
?plot
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
vexp = fit$sdev^2
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 800, height = 600, pointsize = 10.5)
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 800, height = 600, pointsize = 12)
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
# Scree
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 600, height = 400, pointsize = 12)
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
# Scree
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 600, height = 400, pointsize = 12)
par(cex = 1.2)
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
# Scree
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 600, height = 400, pointsize = 12)
par(cex = 1.5)
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
# Scree
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 800, height = 600, pointsize = 12)
par(cex = 1.5)
plot(1:44, vexp/sum(vexp),
xlab = 'Component',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
# Scree
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree1.png',
width = 800, height = 600, pointsize = 12)
par(cex = 1.5)
plot(1:44, vexp/sum(vexp),
xlab = 'Factor',
ylab = 'Variance Explained',
type = 'b')
grid(nx = NULL, ny = NULL)
dev.off()
?points
# Scree
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree2.png',
width = 800, height = 600, pointsize = 12)
par(cex = 1.5)
plot(1:44, vexp/sum(vexp),
xlab = 'Factor',
ylab = 'Variance Explained',
type = 'b')
points(1:5, vexp[1:5/sum(vexp),
col = 'red',
pch = 16)
grid(nx = NULL, ny = NULL)
dev.off()
vexp = fit$sdev^2
png(filename = '../Latex/figures/personality_scree2.png',
width = 800, height = 600, pointsize = 12)
par(cex = 1.5)
plot(1:44, vexp/sum(vexp),
xlab = 'Factor',
ylab = 'Variance Explained',
type = 'b')
points(1:5, vexp[1:5]/sum(vexp),
col = 'red',
pch = 16)
grid(nx = NULL, ny = NULL)
dev.off()
